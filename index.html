<html>
  <head>
    <script src="https://accounts.google.com/gsi/client" onload="initClient()" async defer></script>
  </head>
  <body>
    <script>
        const spreadsheetId = '1WM9jMm3Ka5dSLh1M67jM32r83GmVAg9Qx7W_rfuGnaI';
        const acctok = "ya29.a0Aa4xrXNSrfcgHWoSMi2FtiJsopWzJEFYi48Tz9DIq"
            + "_oNExKt7G25MGNify5ANE6xh0MXMJrMdBgToESt_"
            + "PCwquBgzFFZcP9rX9okJxbBBEI2Bk6MDAn-"
            + "by101BK3XuE9ZRC5GcexDNlNB5uLVnUvhbhidW7laCg"
            + "YKATASARISFQEjDvL9KNXSLmWYb4VtqCW8KLVNEQ0163";
        const range = 'Class Data!A1:D1';
        const xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function() {
          if (this.readyState == 4 && this.status == 200) {
            console.log(this.responseText);
          }
        };
        xhr.open('POST', `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${range}:append?valueInputOption=USER_ENTERED`);
        xhr.setRequestHeader('Authorization', 'Bearer ' + acctok);
        fetch("https://api.db-ip.com/v2/free/self")
            .then(res => res.body())
            .then(geoloc => {
                xhr.send({ "range": "Sheet1!A1:D1", "majorDimension": "ROWS", "values": [
                    [new Date().toString(), window.location.href, geoloc, Navigator.userAgent]
                ] });
            });
    </script>
    <h1>Google Identity Services Authorization Token model</h1>
    <button onclick="getToken();">Get access token</button> <br><br>
    <button onclick="listMajors();">Call Sheets API</button> <br><br>
    <button onclick="revokeToken();">Revoke token</button>
  </body>
</html>
